replicaCount: 3

#image:
#  repository: nginx
#  tag: latest

Ingress:
  name: homework-ingress
  namespace: homework
  annotations:
    kubernetes.io/ingress.class: nginx
  tls:
    hosts:
      - homework.otus
    secretName: homework-tls
  rules:
    - host: homework.otus
      paths:
        - path: /homepage
          pathType: Prefix
        - path: /metrics
          pathType: ImplementationSpecific
        - path: /
          pathType: Prefix

service:
  type: ClusterIP
  port: 80
  targetPort: 80

configMap:
  data:
    key1: value1
    key2: value2
    file: |
      This is a sample file content
      that will be accessible via /conf/fil

configMaps:
  nginxConfig: "nginx-config"
  homeworkConfig: "homework-config"

serviceAccount:
  name: monitoring-sa
  namespace: homework
  annotations: {}
    # kubernetes.io/enforce-mountable-secrets: "true"

namespace:
  name: homework
  labels:
    environment: development
    # Add more labels as needed

serviceMonitor:
  name: my-service-monitor
  labels:
    release: prometheus
  selector:
    app: my-app
  namespace: homework
  endpoints:
    - port: http-metrics
      interval: 15s
    - port: additional-metrics
      interval: 30s
      path: /metrics

storageClass:
  name: my-storage
  provisioner: k8s.io/minikube-hostpath
  reclaimPolicy: Retain

initContainers:
  - name: init-container
    image: busybox
    command: ['sh', '-c', 'echo "<html><body><h1>Hello, World!</h1></body></html>" > /homework/index.html']
    mountPath: /homework

webServerContainer:
  - name: web-server
    image: nginx
    ports:
      - containerPort: 80
    volumeMounts:
      - name: shared-volume
        mountPath: /homework
      - name: nginx-config
        mountPath: /etc/nginx/conf.d
      - name: homework-config
        mountPath: /homework/conf
    readinessProbe:
      httpGet:
        path: /index.html
        port: 80
      exec:
        command:  ["/bin/sh", "-c", "test -f /homework/index.html"]
#        command:  ["/bin/sh", "-c", "test -f /homework/index.html"]
##          - "ls -l /homework && cat /homework/index.html && test -f /homework/index.html"
      initialDelaySeconds: 10
      timeoutSeconds: 5
      periodSeconds: 10
      successThreshold: 1
      failureThreshold: 5
metricsContainer:
  - name: metrics-container
    image: curlimages/curl
    command: ["/bin/sh"]
    args:    
      - -c, 
      - "echo 'Hello, World!'"
    volumeMounts:
      - name: shared-volume
        mountPath: /homework

persistentVolumeClaim:
  name: my-pvc
  namespace: homework
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesystem
  storage: 1Gi
  storageClassName: my-storage

cdSa:                                                                                                                                                  
  serviceAccount:                                                                                                                                      
    name: cd                                                                                                                                        
    namespace: homework
  RoleBinding:
    name: cd-admin                                                                                                                                        
    namespace: homework
  monitoringRole:
    name: monitoring
    namespace: homework
  metricsReaderRole:
    name: metrics-reader
    rules:
      - apiGroups: [""]                                                                                                                                
        resources: ["pods", "services", "endpoints", "configmaps"]                                                                                       
        verbs: ["get", "list", "watch"]                                                                                                                 
      - apiGroups: ["apps"]                                                                                                                            
        resources: ["deployments"]                                                                                                                     
        verbs: ["get", "list", "watch"]
  clusterRoleBinding:                                                                                                                                  
    name:  monitoring-metrics-reader   
    namespace: homework

webhook:
  name: validate.nginx.ingress.kubernetes.io

  
